# 17章 戦略をまとめ上げる
## 誰が戦略を策定するのか？

戦略的設計

+ "コンテキスト・蒸留・大規模な構造"の設計のことだと理解
  + プロジェクトを編成する(P498 下から二段落目)
  + 戦略的設計自体はコードを書くものではないが、開発全体に影響を与える(P500 下から2段落目)
  + 私は**戦略的設計**とその他の設計を区別したが、それはそこに伴う作業を明白にするためであった。深いモデルに基づいてしなやかな設計を作成することは高度な設計作業だが、詳細が極めて重要なので、こうした設計作業は開発者が行わなければならない。戦略的設計はアプリケーション設計から生まれてくるものだが、活動に関する全体的な見方も必要とする。


アーキテクチャは開発チームより権力を持つチームに作成されがちだが、大抵うまくいかない

-> 権力を持つチーム: アーキテクチャチームや、上流工程の人？

意思決定プロセスを効果的にするためには原理が必要なので、戦略的設計はプロジェクト全体に適用しなければならない

実践で価値を提供していた2つのスタイル

+ アプリケーション開発から現れる構造
+ 顧客に焦点を合わせたアーキテクチャチーム

### アプリケーション開発から現れる構造

> 優れたコミュニケーション能力を持つメンバで構成される自己規律型のチームは中央の権威がなくても機能し、**進化する秩序**に従って、共有された原則の集合を生み出せる。その秩序は命令によらず有機的に成長する。

+ 進化する秩序(P450 ~ P452)
  > 概念上の大規模な構造をアプリケーションと共に進化させ、場合によっては途中で全く別の種類の構造に変更すること。詳細な知識を必要とする、設計とモデルに関する詳細な意思決定を、制約しすぎてはならない

+ 理論上は、こうした構造はどのプログラミングペアの洞察からでも、自然発生的に現れる可能性がある
+ 大抵の場合、大規模な構造を監督する責任を、個人やチーム内の小さなグループに負わせると、構造の統一を維持しやすくなる
  + 非公式なリーダーが実践的な開発者である場合、このアプローチはうまくいく
  + こうしたリーダーは、調停役や伝達役であって、アイデアの唯一の源泉でないのが良い
  + 当然、開発チームには、プロジェクト全体に影響することになる設計上の意思決定を行う才能のある人が、少なくとも数人はいなければならない

大規模な構造が複数チームにまたがる場合

+ 密接に協力し合っているチーム同士が非公式に協調し始めるかもしれない
+ 複数のチームが緩やかな協力関係で一緒に仕事を進めようとするが、機能するのは、
  + チームの数が比較的少なく、
  + どのチームも互いに協調することに積極的で、
  + 似たような設計能力を持っており、
  + 単一の大規模な構造で満たせるくらい構造への要求が類似している場合である
  + -> つまりかなりうまくいく為の条件は厳しい

### 顧客に焦点を合わせたアーキテクチャチーム

中央集権化を行ったからと言って、失敗するとは限らない

+ 象牙の塔のアーキテクト

+ アーキテクチャチームが、さまざまなアプリケーションチームに対して同僚として行動することができ
+ **境界付けられたコンテキスト**やチーム間の技術的な問題に加え、大規模な構造も調整して一致させやすくする
+ そのためには、アプリケーション開発を重要視するという心構えが必要

組織図を見ると、従来のアーキテクチャチームと同じように見えるが、実態は異なる

+ メンバーは開発者に対する真の協力者
+ 開発者と一緒にパターンを見つける
+ さまざまなチームと実験して上流に到達し、自ら手を動かす

(開発を委託するときは、どうすればいいんだろう？)

このシナリオを著者は2回見たことがあるらしいが、次節に挙げる内容のほとんどを実装するアーキテクトリーダーが誕生していたそうである。

## 戦略的設計上の意思決定を行うために欠かせない6つのこと

+ 意思決定はチーム全体に伝えなければならない
+ 意思決定プロセスはフィードバックを吸収しなければならない
+ 計画は進化を許容しなければならない
+ アーキテクチャチームが、最も優秀な人材を全て吸い上げてはならない
+ 戦略的設計にはminimalismと謙虚さが必要である。
+ オブジェクトはスペシャリストだが、開発者はジェネラリストである

### 意思決定はチーム全体に伝えなければならない

+ 誰もが戦略を理解してそれに従わなければ意味がない
+ アーキテクトにフィードバックがなければ、実態に則さないルールが出来上がり、開発者は抜け道を探したり無視したりする
+ どんなシステムであっても、経営者が与える権威より、開発者が戦略に対して持つ実際の関係の方を重視すべし

### 意思決定プロセスはフィードバックを吸収しなければならない

+ ドメインの概念に対する深い理解を持っているのが、アプリケーション開発チームのメンバである
+ アーキテクトがどれだけ優秀であっても、アーキテクチャを決めるときにアプリケーション開発チームの参加させた方が良い

+ 著者の経験
  > アーキテクチャチームが、そのフレームワークを使おうとしているさまざまなチームの間を回って意見を聞いていた。こうすることで、アーキテクチャチームは開発者が直面する課題の実地経験を吸い上げるのと同時に、フレームワークを適用する際の機微についても、知識の引き継ぎを行っていたのである
  + 戦略的設計にも、これと同じ密接なフィードバックループが必要である

### 計画は進化を許容しなければならない

+ 多くの設計上の意思決定は、課せられた問題を解決する為の柔軟性がないせいで、開発チームの進行を妨げかねない
+ 原理は、開発プロジェクトの進行に合わせて成長し、変化しなければならないものである

### アーキテクチャチームが、最も優秀な人材を全て吸い上げてはならない

+ 戦略的設計をするためには優秀な人が必要なため、優秀な人を集めがち
+ 開発者にも優秀な人を置かないと、戦略的設計を使いこなせず失敗しがち。有能な戦略チームであっても、有能なアプリケーションチームをパートナーとして持たなければならない。
+ アーキテクチャチームに、設計スキルはないがドメインの経験が豊富なひとやドメインエキスパートも入れた方が良い

### 戦略的設計にはミニマリズムと謙虚さが必要である。

+ 戦略的設計を作りすぎないこと
+ うまい設計ができたからといって謙虚でいないと、ミニマリズムが実現できない

### オブジェクトはスペシャリストだが、開発者はジェネラリストである

+ オブジェクトには明白で限定された責務を与えること
+ 開発者に対しては、他人のことに首を突っ込むぐらいの方が良い

著者が**戦略的設計**と**その他の設計**を区別したのは、そこに伴う作業を明白にするため

注意すべきこと

+ 二種類の設計作業があるからといって、人々を二種類に分けることはない
  + 戦略的設計は複数チームにまたがっているかもしれない

一般的には、設計のエキスパートがビジネスを知る必要がなくドメインエキスパートが技術を理解しなくても済んできる方法が求められるが、過度の専門家はドメイン駆動設計から推進力を奪ってしまう

## 同じことが技術的なフレームワークにも当てはまる

技術的なフレームワーク: インフラストラクチャ層を提供してアプリケーションを基本的なサービスの実装から解放するが、**ドメインモデルの表現力豊かな実装と容易な変更を妨げかねない**

逆に、フレームワーク設計者にとって、ドメインそうやアプリケーションへ足を踏み入れるつもりがない場合のみ発生する。

戦略的設計のマイナス面を制限するのと同じ方向付けが、技術的アーキテクチャでも有効なことがある。

+ 進化
+ ミニマリズム
+ アプリケーション開発チームの参加

### 素人にもわかるフレームワークを作成してはならない(という姿勢のことだと思う)

確実にフレームワークを台無しにする独特の態度であるとのこと。

+ 設計ができない人にはソフトウェア開発をさせず逆に賢い人だけ面倒をみると、かえって担当者が必要とするツールとの間に障壁を作り出す
+ チーム間の関係を害する

**ビジネスと無関係な技術的詳細をカプセル化すること**は、著者が非難しているプリパッケージの類とは別物

設計者がユーザに高い敬意を払っているなら、正しい方向を向いているであろう

> プリパッケージ: 商品の購買を予想して，あらかじめその商品の包装を行なっておくこと。(コトバンク)


# マスタプランに注意すること

> マスタプラン: 建築と都市計画の分野において、十分な指針を定めることによって、全体としての環境に一貫性を提供しながら、ここの建築物やオープンスペースには局所的な要求に適合する自由を残す方法。

Alexanderが言ったマスタプランが失敗する理由

+ マスタプランによって作り出されるものが全体主義的な秩序であって、有機的な秩序でない。
+ あまりにも厳格すぎるため、共同体の生活で当然発生する、自然で予想できない変化に対し、容易には適合できない。

Alexanderが代わりに提唱したもの

段階的成長に関するあらゆる活動に対して、共同体のメンバ全員が適用できる**原理の集合**。
それによって、状況にうまく適合した「有機的秩序」が姿を表すようにした
